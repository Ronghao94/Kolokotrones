---
output: github_document
editor_options: 
  markdown: 
    wrap: 80
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
# Please put your title here to include it in the file below.
Title <- "Replicating Figure 1a in Kolokotrones, 2010" 
```

# Kolokotrones

[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/Ronghao94/Kolokotrones/master?urlpath=rstudio)

A longstanding problem in biology is to characterize the scaling relationship
between basal metabolic rate and body mass. In a landmark paper published in
*Nature*, Kolokotrones *et al.* (2010) show that the relationship takes on a
convex curvature on a logarithmic scale. In this compendium, we provide the
data, code, and other R tools to replicate Figure 1a from this paper.

### How to cite

Please cite this compendium as:

> Fung, Hannah; Valbuena, Raeline; Zhou, Ronghao.
> (`r format(Sys.Date(), "%Y")`). *Compendium of R code and data for
> `Replicating Figure 1a in Kolokotrones, 2010`*. Accessed
> `r format(Sys.Date(), "%d %b %Y")`. Online at
> <https://github.com/Ronghao94/Kolokotrones>

## Contents

The **analysis** directory contains:

-   [:file_folder: paper](/analysis/paper): R Markdown source document for
    manuscript. Includes code to reproduce the figure generated by the analysis.
    It also has a rendered version, `paper.docx`, suitable for reading (the code
    is replaced by figures in this file).
-   [:file_folder: data](/analysis/data): Data used in the analysis.
-   [:file_folder: figures](/analysis/figures): Plots and other illustrations.
-   [:file_folder: templates](/analysis/templates): Templates used to build this
    research compendium.

## Installation

This research compendium has been developed using the statistical programming language R. To work with the compendium, you will need installed on your computer the [R software](https://cloud.r-project.org/) itself and optionally
[RStudio Desktop](https://rstudio.com/products/rstudio/download/).

You can download the compendium as a zip from this URL:
[master.zip](https://github.com/Ronghao94/Kolokotrones/archive/refs/heads/main.zip).
After unzipping:

-   open the `.Rproj` file in RStudio
-   run `devtools::install()` to ensure you have the packages this analysis depends on (also listed in the [DESCRIPTION](/DESCRIPTION) file)
-   finally, open `analysis/paper/paper.Rmd` and knit to produce the `paper.docx`, or run `rmarkdown::render("analysis/paper/paper.Rmd")` in the R console

## Usage

The large sizes of orcas and elephants have the potential to disproportionately affect model fit. Consequently, orcas and elephants were excluded from the dataset used to fit the linear and quadratic models. We wrote a function `subset_data()` to prepare the data for model fitting.

Load the required packages:
```{r}
library(Kolokotrones)
library(dplyr)
library(readxl)
library(stringr)
```

Load and prepare the data:
```{r}
data <- read_excel(here::here("analysis/data/41586_2010_BFnature08920_MOESM90_ESM.xls"), skip = 6)
names(data) <- str_replace_all(names(data), c(" " = ".", "[(]" = "", "[)]" = ""))
```

Run `subset_data()` to drop orcas and elephants from the dataset.
```{r}
drop_genera <- (c("Elephantulus", "Orcinus"))
sub_data <- subset_data(data, drop_genera)
head(sub_data)
```

### Licenses

**Text and figures :** [CC-BY-4.0](http://creativecommons.org/licenses/by/4.0/)

**Code :** See the [DESCRIPTION](DESCRIPTION) file

**Data :** [CC-0](http://creativecommons.org/publicdomain/zero/1.0/) attribution
requested in reuse

### Contributions

We welcome contributions from everyone. Before you get started, please see our
[contributor guidelines](CONTRIBUTING.md). Please note that this project is
released with a [Contributor Code of Conduct](CONDUCT.md). By participating in
this project you agree to abide by its terms.
